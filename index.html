<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Restart Schools</title>
  <!-- fonts -->
  <link href="https://fonts.googleapis.com/css?family=Lato:300i,400,400i,700,900" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
    crossorigin="anonymous"></script>
  <link rel="stylesheet" href="css/main.css" type="text/css">
  <!-- d3 -->
  <!-- <script src="https://d3js.org/d3.v4.min.js" charset="utf-8"></script> -->
  <script src="js/d3.v4.min.js" charset="utf-8"></script>
  <script src="https://d3js.org/topojson.v1.min.js"></script>
  <script src="https://d3js.org/d3-queue.v2.min.js"></script>
  <script src="data/restart-schools.geojson"></script>
  <script src="data/basic_data.js"></script>

  <!-- custom styles -->
  <link rel="stylesheet" href="css/main.css" type="text/css">

  <style>
  </style>

</head>

<body>
  <!-- <header>
    <img src="images/header.jpg" alt="">
    <p style="margin-top:20px;">THIS IS A COMPELLING LEDE. Donec euismod metus vel sem viverra, nec dignissim purus fringilla. Donec suscipit congue nunc,
        sit amet ultricies mi vestibulum dapibus. Ut et consectetur eros. Phasellus turpis nibh, placerat a neque sed, blandit
        aliquam quam. Vivamus hendrerit malesuada luctus. Nulla gravida orci non fringilla elementum. Praesent nisi metus, vulputate
        in purus et, pulvinar posuere tellus. Nulla facilisi. Quisque quis orci nec tortor dignissim pharetra ac nec orci. Mauris
        aliquet, metus id ultrices sagittis, neque dolor efficitur odio, vel ultricies neque elit eu libero. In suscipit libero
        purus, id rhoncus arcu venenatis in</p>
      </header> -->
  <div id="top-explorer">
    
    <div id="top-sidebar">
        <div>
            <h1 id="waypoint1">Restart Schools Graphic</h1>
            <p>There are 103 schools approved for restart status in North Carolina.</p>
          </div>
          <div id="schools-map">
              <svg width="960" height="500"></svg>
          </div>
          <div id="waypoint1a">
            <p>Most restart schools are located in
              <span data-fip="063" class="map-link map-hover-item">Durham</span>,
              <span class="map-link map-hover-item" data-fip="159">Rowan-Salisbury</span>, and
              <span data-fip="183" class="map-link map-hover-item">Wake</span> counties. When adjusted for population,
              <span data-fip="083" class="map-link map-hover-item">Weldon City Public Schools</span> in Halifax County has the highest proportion of students in restart schools, with
              about 67 percent of their students in restart schools.</p>
            <p> Top 10 Counties with Most Restart Schools</p>
            <table class="table percent-table">
              <tr>
                <th class="table-text">School district</th>
                <th class="table-text percent-students">Percent of students in restart schools</th>
              </tr>
              <tr data-fip="083" class="map-hover-item">
                <td class="table-text">Weldon City (located in Halifax County)</td>
                <td class="table-num">67%</td>
              </tr>
              <tr data-fip="187" class="map-hover-item">
                <td class="table-text">Washington</td>
                <td class="table-num">50</td>
              </tr>
              <tr data-fip="083" class="map-hover-item">
                <td class="table-text">Halifax County</td>
                <td class="table-num">49</td>
              </tr>
              <tr data-fip="159" class="map-hover-item">
                <td class="table-text">Rowan-Salisbury</td>
                <td class="table-num">40</td>
              </tr>
              <tr data-fip="131" class="map-hover-item">
                <td class="table-text">Northampton County</td>
                <td class="table-num">26</td>
              </tr>
              <tr data-fip="063" class="map-hover-item">
                <td class="table-text">Durham</td>
                <td class="table-num">25</td>
              </tr>
              <tr data-fip="015" class="map-hover-item">
                <td class="table-text">Bertie</td>
                <td class="table-num">20</td>
              </tr>
              <tr data-fip="139" class="map-hover-item">
                <td class="table-text">Elizabeth City/Pasquotank</td>
                <td class="table-num">17</td>
              </tr>
              <tr data-fip="037" class="map-hover-item">
                <td class="table-text">Chatham</td>
                <td class="table-num">14</td>
              </tr>
              <tr data-fip="025" data-fip2="159" class="map-hover-item">
                <td class="table-text">Kannapolis City (in Cabarrus and Rowan counties)</td>
                <td class="table-num">41</td>
              </tr>
            </table>
            <p id="waypoint2"></p>
            <div id="highlight-map">
                <svg width="960" height="500"></svg>
            </div>
          </div>
        
          <div>
            <p>(Explanation of how school performance grades work)</p>
            </div>
            <div id="line-chart">
                <svg width="960" height="500"></svg>
              </div>
              
            <div>
            <p>The median school performance grade (SPG) of restart schools in the past three school years is 47. The median SPG of
              all schools in the state in the past three schools years is 62.</p>
          </div>
          <div id="waypoint3"></div>
          <div>
            <p>show: a bar graph like the one in my original sketch showing racial/ethnic breakdown, but with two sets of bars to compare
              statewide vs restart text: (some sentence describing an interesting pullout from this data)</p>
          </div>
          <div id="bar-chart" class="story">
              <svg id="bar-1" width="400" height="200"></svg>
              <svg id="bar-2" width="400" height="200"></svg>
            </div>
        
        
          <div id="waypoint4">
            <p>The percentage of economically disadvantaged students is reported by the state in ranges: (Draw an svg line showing the
              ranges)
            </p>
          </div>
          <div id="scale1">
              <img src="images/scale-01.png" alt="" style="width:800px;">
            </div>
            
          <div id="waypoint5">
            <p> The median percentage of economically disadvantaged students in the state is between 60 and 65 percent. (Highlight this
              range on the line)
            </p>
          </div>
          <div id="scale2">
              <img src="images/scale-02.png" alt="" style="width:800px;">
            </div>
        
          <div id="waypoint6">
            <p>The median percentage of economically disadvantaged students in restart schools is greater than 90%.</p>
          </div>
    </div><!--/#top-explorer-->

</div>
  <hr id="waypoint6">
<div id="bottom-explorer">

  <div class="flex-center">
    <h1>Explore individual schools</h1>
  </div>

  <div id="school-list">
    <h1>list of schools</h1>
  </div>
  <div id="data-list"></div>

</div> <!--/#bottom-explorer -->

  <div class="wrapper">
    <header class="header">My header</header>
    <aside class="sidebar">Sidebar</aside>
    <article class="content">
      <h1>2 column, header and footer</h1>
      <p>This example uses line-based positioning, to position the header and footer, stretching them across the grid.</p>
    </article>
    <footer class="footer">My footer</footer>
  </div>


  <script type="text/javascript" src="js/d3-maps.js"></script>


  <script type="text/javascript">
    $(document).ready(function () {
      //WAYPOINTS
      var waypoint = new Waypoint({
        element: document.getElementById('waypoint1'),
        handler: function () {
          // $('#schools-map svg').toggleClass("fixed");

        }
      })

      var waypoint = new Waypoint({
        element: document.getElementById('waypoint1a'),
        handler: function () {
          console.log("1a");
          $('.percent-table').toggleClass("swirl-in-fwd");

        }
      })

      //trigger the line chart
      var waypoint = new Waypoint({
        element: document.getElementById('waypoint2'),
        handler: function () {
          // $('#line-chart').toggleClass("inline-block");
          // $('#schools-map svg').toggleClass("fixed");
          // $('#line-chart svg').toggleClass("fixed");

        }
      })

      //trigger the bar chart
      var waypoint = new Waypoint({
        element: document.getElementById('waypoint3'),
        handler: function () {
          // $('#line-chart').toggleClass("inline-block");
          // $('#bar-chart').toggleClass("inline-block");
          // $('#line-chart svg').toggleClass("fixed");
          // $('#bar-chart svg').toggleClass("fixed");

        }
      })

      var waypoint = new Waypoint({
        element: document.getElementById('waypoint4'),
        handler: function () {

          // $('#bar-chart').toggleClass("inline-block");
          // $('#scale1 img').toggleClass("inline-block");
          // $('#scale1 img').toggleClass("fixed");
          // $('#bar-chart svg').toggleClass("fixed");

        }
      })

      var waypoint = new Waypoint({
        element: document.getElementById('waypoint5'),
        handler: function () {
          // $('#scale1 img').toggleClass("inline-block");
          // $('#scale1 img').toggleClass("fixed");
          // $('#scale2 img').toggleClass("inline-block");
          // $('#scale2 img').toggleClass("fixed");

        }
      })

      var waypoint = new Waypoint({
        element: document.getElementById('waypoint6'),
        handler: function () {
          // $('#scale2 img').toggleClass("inline-block");
          // $('#scale2 img').toggleClass("fixed");

        }
      })


      $('.map-hover-item').hover(function (e) {
        var thisFip = $(this).data('fip');
        if ($(this).data('fip2') != null) {
          thisFip2 = $(this).data('fip2');
          $('.fip_' + thisFip2).toggleClass('county-highlight');
        }
        console.log("fip_" + thisFip);

        $('.fip_' + thisFip).toggleClass('county-highlight');

      });

      //TODO: POPULATE THE BOTTOM EXPLORER
      for (i in ALL_DATA) {
        //1) build the data into the DOM
        var school = ALL_DATA[i];
        var keys = Object.keys(school);
        //1a. create the data wrappers
        $('#data-list').append('<div style="margin:3vh;" class="data-lister" id="waypoint_' + school.school_code + '">' + school.official_school_name + '</div>');

        //1b. iterate thru the data keys
        for (j in keys) {
          thisKey = keys[j];
          $('#waypoint_' + school.school_code).attr('data-' + thisKey, school[thisKey]);
        }

        $('#school-list').append('<p>' + school.official_school_name + '</p>');


        window["waypoint_" + school.school_code] = new Waypoint({
          element: document.getElementById("waypoint_" + school.school_code),
          handler: function () {
            var school = this.element.dataset;
            console.log("we've triggered for: " + school.official_school_name)
          }
        })

      } //data for loop


    }); //doc ready


  </script>
  <!-- waypoints -->
  <script src="js/jquery.waypoints.min.js"></script>

</body>

</html>